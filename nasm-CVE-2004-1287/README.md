source: https://www.securityfocus.com/bid/11991/info

NASM is prone to a buffer overflow. This condition is exposed when the application attempts to assemble a source file that contains malformed '%error' preprocessor directive arguments. Since the source file may originate from an external or untrusted source, this vulnerability is considered remote in nature.

Successful exploitation will permit arbitrary code execution with the privileges of the user running the application. 

https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/25005.zip

### Build
```
mkdir nasm
tar xf xxx.tar.gz -C nasm
cd nasm
autoconf
CC=wllvm CFLAGS='-g -O0' ./configure
make
# trigger crash
./nasm poc.S
```

### klee-record
```
klee -solver-backend=stp -call-solver=false -use-forked-solver=false -output-source=false -write-kqueries -write-paths --libc=uclibc --posix-runtime -env-file=env -pathrec-entry-point="__klee_posix_wrapped_main" -ignore-posix-path=true -use-independent-solver=false -oob-check=false -allocate-determ ./nasm.bc ../poc.S
```

### klee-replay
```
klee -solver-backend=stp -call-solver=false -oracle-KTest=oracle.ktest -use-forked-solver=false -output-source=false -write-kqueries -write-paths --libc=uclibc --posix-runtime -env-file=env -pathrec-entry-point="__klee_posix_wrapped_main" -ignore-posix-path=true -replay-path=klee-out-0/test000001.path -use-independent-solver=true -rewrite-equalities=false -oob-check=true -allocate-determ ./nasm.bc poc.S -sym-file poc.S 2213
```
